<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title th:text="${titulo}">Entrenadores</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
	<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
	<style>
		.navbar-custom {
			background: linear-gradient(135deg, #2c3e50, #34495e);
		}

		.card-custom {
			border: none;
			border-radius: 10px;
			box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
		}

		.btn-primary-custom {
			background: linear-gradient(135deg, #3498db, #2980b9);
			border: none;
		}

		.entrenador-card {
			transition: transform 0.2s;
		}

		.entrenador-card:hover {
			transform: translateY(-5px);
		}

		.nacionalidad-badge {
			font-size: 0.9rem;
			padding: 0.4rem 0.8rem;
		}

		.header-custom {
			background: linear-gradient(135deg, #e74c3c, #c0392b);
		}

		.search-box {
			border-radius: 25px;
		}

		.edad-badge {
			font-size: 1rem;
			font-weight: bold;
		}

		.club-info {
			background-color: #f8f9fa;
			border-radius: 5px;
			padding: 10px;
		}

		.sin-club {
			color: #95a5a6;
			font-style: italic;
		}
	</style>
</head>

<body>
	<!-- Navigation -->
	<nav class="navbar navbar-expand-lg navbar-dark navbar-custom">
		<div class="container">
			<a class="navbar-brand" th:href="@{/}">
				<i class="fas fa-futbol me-2"></i>Sistema de Fútbol
			</a>
			<div class="navbar-nav ms-auto">
				<a class="nav-link" th:href="@{/}">Inicio</a>
				<a class="nav-link" th:href="@{/asociaciones}">Asociaciones</a>
				<a class="nav-link" th:href="@{/clubes}">Clubes</a>
				<a class="nav-link" th:href="@{/jugadores}">Jugadores</a>
				<a class="nav-link" th:href="@{/entrenadores}">Entrenadores</a>
				<a class="nav-link" th:href="@{/competiciones}">Competiciones</a>
				<a class="nav-link" th:href="@{/h2-console}" target="_blank">Base de Datos</a>
			</div>
		</div>
	</nav>

	<div class="container mt-4">
		<!-- Header -->
		<div class="d-flex justify-content-between align-items-center mb-4">
			<h2><i class="fas fa-user-tie me-2"></i> <span th:text="${titulo}">Entrenadores</span></h2>
			<a th:href="@{/entrenadores/nuevo}" class="btn btn-primary-custom text-white">
				<i class="fas fa-plus me-2"></i>Nuevo Entrenador
			</a>
		</div>

		<!-- Búsqueda y Filtros -->
		<div class="card card-custom mb-4">
			<div class="card-body">
				<form th:action="@{/entrenadores/buscar}" method="get">
					<div class="input-group mb-3">
						<span class="input-group-text">
							<i class="fas fa-search"></i>
						</span>
						<input type="text" class="form-control search-box" name="nacionalidad"
							placeholder="Buscar entrenador por nacionalidad..." required>
						<button class="btn btn-primary-custom" type="submit">
							<i class="fas fa-search me-2"></i>Buscar
						</button>
						<a th:href="@{/entrenadores}" class="btn btn-outline-secondary">
							<i class="fas fa-redo me-2"></i>Ver Todos
						</a>
					</div>
				</form>

				<!-- Filtro adicional -->
				<div class="d-flex gap-2">
					<a th:href="@{/entrenadores/sin-club}" class="btn btn-outline-warning">
						<i class="fas fa-users-slash me-2"></i>Ver Entrenadores Sin Club
					</a>
				</div>
			</div>
		</div>

		<!-- Lista de entrenadores -->
		<div class="card card-custom">
			<div class="card-body">
				<!-- Mensaje cuando no hay entrenadores -->
				<div th:if="${entrenadores == null or entrenadores.empty}" class="text-center py-5">
					<i class="fas fa-clipboard-user fa-4x text-muted mb-3"></i>
					<h5 class="text-muted">No hay entrenadores registrados</h5>
					<p class="text-muted">Comienza agregando un nuevo entrenador al sistema.</p>
					<a th:href="@{/entrenadores/nuevo}" class="btn btn-primary-custom text-white">
						<i class="fas fa-plus me-2"></i>Crear Primer Entrenador
					</a>
				</div>

				<!-- Grid de entrenadores -->
				<div th:unless="${entrenadores == null or entrenadores.empty}" class="row">
					<div th:each="entrenador : ${entrenadores}" class="col-md-6 col-lg-4 mb-4">
						<div class="card h-100 entrenador-card">
							<!-- Header de la tarjeta -->
							<div class="card-header text-white header-custom">
								<div class="d-flex justify-content-between align-items-center">
									<h6 class="mb-0">
										<i class="fas fa-user-tie me-2"></i>
										<span th:text="${entrenador.nombre + ' ' + entrenador.apellido}">Nombre
											Completo</span>
									</h6>
									<span class="badge bg-light text-dark edad-badge">
										<span th:text="${entrenador.edad}">0</span> años
									</span>
								</div>
							</div>

							<!-- Cuerpo de la tarjeta -->
							<div class="card-body">
								<p class="card-text mb-2">
									<i class="fas fa-signature me-2 text-muted"></i>
									<strong>Nombre:</strong>
									<span th:text="${entrenador.nombre}">Nombre</span>
								</p>

								<p class="card-text mb-2">
									<i class="fas fa-id-card me-2 text-muted"></i>
									<strong>Apellido:</strong>
									<span th:text="${entrenador.apellido}">Apellido</span>
								</p>

								<p class="card-text mb-2">
									<i class="fas fa-calendar-alt me-2 text-muted"></i>
									<strong>Edad:</strong>
									<span th:text="${entrenador.edad}">Edad</span> años
								</p>

								<p class="card-text mb-2">
									<i class="fas fa-flag me-2 text-muted"></i>
									<strong>Nacionalidad:</strong>
									<span class="badge bg-info text-white nacionalidad-badge">
										<i class="fas fa-globe me-1"></i>
										<span th:text="${entrenador.nacionalidad}">Nacionalidad</span>
									</span>
								</p>

								<hr>

								<!-- Información del club -->
								<div class="club-info text-center">
									<div th:if="${entrenador.club != null}">
										<i class="fas fa-shield-alt fa-2x text-success mb-2"></i>
										<p class="mb-0">
											<strong>Club Actual:</strong>
										</p>
										<p class="text-primary fw-bold mb-0" th:text="${entrenador.club.nombre}">
											Nombre del Club
										</p>
									</div>
									<div th:if="${entrenador.club == null}">
										<i class="fas fa-shield-alt fa-2x text-muted mb-2"></i>
										<p class="sin-club mb-0">
											<i class="fas fa-ban me-1"></i>Sin club asignado
										</p>
									</div>
								</div>
							</div>

							<!-- Footer con acciones -->
							<div class="card-footer bg-transparent">
								<div class="btn-group w-100" role="group">
									<!-- Botón ver club (si tiene) -->
									<a th:if="${entrenador.club != null}"
										th:href="@{/clubes/ver/{id}(id=${entrenador.club.id})}"
										class="btn btn-sm btn-outline-info"
										th:title="'Ver club: ' + ${entrenador.club.nombre}">
										<i class="fas fa-shield-alt"></i> Ver Club
									</a>

									<!-- Botón editar -->
									<a th:href="@{/entrenadores/editar/{id}(id=${entrenador.id})}"
										class="btn btn-sm btn-outline-warning">
										<i class="fas fa-edit"></i> Editar
									</a>

									<!-- Botón eliminar -->
									<!-- ✅ SOLUCIÓN CORRECTA -->
									<form th:action="@{/entrenadores/eliminar/{id}(id=${entrenador.id})}" method="get"
										class="d-inline eliminar-form"
										th:attr="data-nombre-completo='¿Estás seguro de eliminar a ' + ${entrenador.nombre} + ' ' + ${entrenador.apellido} + '?'">
										<button type="submit" class="btn btn-sm btn-outline-danger">
											<i class="fas fa-trash"></i> Eliminar
										</button>
									</form>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>

		<!-- ✅ SOLUCIÓN ALTERNATIVA MÁS SEGURA -->
		<div th:if="${entrenadores != null and !entrenadores.empty}" class="row mt-4">
			<div class="col-md-3">
				<div class="card card-custom text-center">
					<div class="card-body">
						<i class="fas fa-user-tie fa-2x text-danger mb-2"></i>
						<h4 th:text="${entrenadores.size()}">0</h4>
						<p class="text-muted mb-0">Total Entrenadores</p>
					</div>
				</div>
			</div>
			<div class="col-md-3">
				<div class="card card-custom text-center">
					<div class="card-body">
						<i class="fas fa-shield-alt fa-2x text-success mb-2"></i>
						<!-- ✅ SIMPLE: Calcular en el controlador -->
						<h4 th:text="${totalConClub != null ? totalConClub : 0}">0</h4>
						<p class="text-muted mb-0">Con Club Asignado</p>
					</div>
				</div>
			</div>
			<div class="col-md-3">
				<div class="card card-custom text-center">
					<div class="card-body">
						<i class="fas fa-users-slash fa-2x text-warning mb-2"></i>
						<!-- ✅ SIMPLE: Calcular en el controlador -->
						<h4 th:text="${totalSinClub != null ? totalSinClub : 0}">0</h4>
						<p class="text-muted mb-0">Sin Club Asignado</p>
					</div>
				</div>
			</div>
			<div class="col-md-3">
				<div class="card card-custom text-center">
					<div class="card-body">
						<i class="fas fa-globe fa-2x text-info mb-2"></i>
						<!-- ✅ SIMPLE: Calcular en el controlador -->
						<h4 th:text="${totalNacionalidades != null ? totalNacionalidades : 0}">0</h4>
						<p class="text-muted mb-0">Nacionalidades</p>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Footer -->
	<footer class="bg-dark text-white mt-5 py-4">
		<div class="container text-center">
			<p class="mb-0">
				<i class="fas fa-futbol me-2"></i>
				Sistema de Gestión de Fútbol &copy; 2024
			</p>
		</div>
	</footer>

	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
</body>
<!-- Scripts adicionales -->
<script>
	document.addEventListener('DOMContentLoaded', function () {
		// Manejar confirmación de eliminación
		document.querySelectorAll('.eliminar-form').forEach(form => {
			form.addEventListener('submit', function (e) {
				const mensaje = this.getAttribute('data-nombre-completo');
				if (!confirm(mensaje)) {
					e.preventDefault();
				}
			});
		});

		// Otras funcionalidades...
	});
</script>

</html>